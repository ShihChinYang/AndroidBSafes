(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2037],{87443:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/services/checkout",function(){return t(30955)}])},18884:function(e,n,t){"use strict";t.d(n,{Z:function(){return l}});var s=t(85893),a=t(67294),c=t(9473),o=t(2859),r=t(13425);function l(e){let{setStripePromise:n}=e,t=(0,c.v9)(e=>e.auth.stripePublishableKey);return(0,a.useEffect)(()=>{t&&((0,r.qu)(!1,"stripePublishableKey"),n((0,o.J)(t)))},[t]),(0,s.jsx)("p",{hidden:!0,children:"Load Stripe"})}},30955:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return f}});var s=t(85893),a=t(67294),c=t(9473),o=t(11163),r=t(33353),l=t(68888),i=t(88083);t(86664);var u=t(81011);t(18884);var p=t(71601),d=t(37383),g=t(13425);function f(){let e=(0,o.useRouter)(),n=(0,c.I0)(),[t,f]=(0,a.useState)(null),[w,h]=(0,a.useState)(null),[b,k]=(0,a.useState)(null),[m,v]=(0,a.useState)(!1),S=(0,c.v9)(e=>e.auth.isLoggedIn),A=(0,c.v9)(e=>e.auth.memberId);(0,c.v9)(e=>e.account.stripeClientSecret);let I=(0,c.v9)(e=>e.account.appleClientSecret),x=(0,c.v9)(e=>e.account.checkoutItem),E=(0,c.v9)(e=>e.account.invoice),T=(0,c.v9)(e=>e.account.checkoutPlan),j=E&&E.planOptions,N=j&&j[T].planId;(0,g.qu)(!0,"isLoggedIn: ".concat(S,", checkoutPlan: ").concat(T));let _=e=>{(0,g.qu)(!0,"savePendingAppleTransaction - "),h(e);let n=localStorage.getItem("pendingAppleTransactions");(n=n?JSON.parse(n):{})[A]=e,n=JSON.stringify(n),localStorage.setItem("pendingAppleTransactions",n)},C=()=>{(0,g.qu)(!0,"clearPendingApppleTransaction - "),h(null);let e=localStorage.getItem("pendingAppleTransactions");(e=e?JSON.parse(e):{})[A]=null,e=JSON.stringify(e),localStorage.setItem("pendingAppleTransactions",e)},P=e=>{"ok"===e.status?(window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.toggleMessageHandler&&window.webkit.messageHandlers.toggleMessageHandler.postMessage({action:"finishTransaction"}),C(),v(!0)):(console.log("reportAnAppleTransactionCallback returns error, pending: ",w),k(e.error))},H=t=>{(0,g.qu)(!0,"transactionWebCall",t);let s=t.transaction;"ok"===t.status?_(s):e.push("/services/payment"),n((0,d.Xz)(p.op.IOSInAppPurchase))};return(0,a.useEffect)(()=>{S&&T&&n((0,d.Pe)({checkoutPlan:T}))},[S,T]),(0,a.useEffect)(()=>{w&&((0,g.qu)(!0,"useEffect - pendingAppleTransaction: ",w),n((0,d.cK)({transaction:w,callback:P})))},[w]),(0,a.useEffect)(()=>{b&&(0,g.qu)(!0,"useEffect - reportAnAppleTransactionErrorn: ",b)},[b]),(0,a.useEffect)(()=>{(0,g.qu)(!0,"appleCientSecret: ",I),I&&(window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.toggleMessageHandler&&(console.log("checkout"),n((0,d.z8)(p.op.IOSInAppPurchase)),window.bsafesNative.transactionWebCall=H,window.webkit.messageHandlers.toggleMessageHandler.postMessage({action:"checkout",planId:N,appleClientSecret:I})),n((0,d.GY)()))},[I]),(0,a.useEffect)(()=>{m&&((0,g.qu)(!0,"Apple transaction is completed."),e.push("/services/appleTransactionCompletion"))},[m]),(0,s.jsxs)(u.Z,{showNaveBar:!1,children:[(0,s.jsxs)(r.Z,{children:[(0,s.jsx)("br",{}),(0,s.jsx)("br",{}),(0,s.jsx)(l.Z,{children:(0,s.jsx)(i.Z,{xs:{span:12},sm:{span:10,offset:1},md:{span:8,offset:2},lg:{span:6,offset:3},children:(0,s.jsx)("div",{style:{borderStyle:"solid"},className:"p-3",children:x&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("p",{children:"Total Amount:"}),(0,s.jsx)("h4",{children:"$".concat((x.amount/100).toFixed(2)," ").concat(x.currency.toUpperCase())})]})})})}),!1,(0,s.jsx)("br",{}),!1]}),!1]})}}},function(e){e.O(0,[3937,8491,1011,2888,9774,179],function(){return e(e.s=87443)}),_N_E=e.O()}]);