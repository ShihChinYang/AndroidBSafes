"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[116],{59215:function(e,t,a){a.d(t,{Z:function(){return W}});var n=a(85893),s=a(67294),l=a(9473),i=a(68888),d=a(88083),r=a(76529),o=a(97056),c=a(18296),u=a(58832),p=a.n(u),h=a(38411),m=a.n(h),f=a(63801),g=a(36622),x=a(53918),v=a(52482),j=a(36762),w=a(19755),y=a.n(w);function N(e){let{id:t}=e;return(0,n.jsx)("div",{className:"bsafesImageSpinner",style:{position:"absolute",textAlign:"center"},children:(0,n.jsx)(c.no,{id:t,visible:!0,height:"80",width:"80",ariaLabel:"blocks-loading",wrapperStyle:{},wrapperClass:"blocks-wrapper"})})}var b=a(84390),_=a(13425);function k(e){let{panelIndex:t,panel:a,onVideoClicked:o,editorMode:c,onContentChanged:u,onPenClicked:p,editable:h=!0}=e,m=(0,l.I0)(),w=(0,s.useRef)(null),k=a.s3KeyPrefix,Z=(0,l.v9)(e=>e.container.workspaceKey),[D,C]=(0,s.useState)(!1),I=(e,t)=>{m((0,b.ig)({files:e,where:t,workspaceKey:Z}))};async function S(e){let t=$('<canvas hidden id = "canvas" width = "640" height = "300"></canvas>'),a=t[0];t.insertAfter("body");let n=parseInt(640/(e.videoWidth/e.videoHeight),10);a.width=640,a.height=n;let s=a.getContext("2d"),l=()=>{if(D)return;console.log("takeAShot..."),console.log("snapshotTaken",D),s.fillRect(0,0,640,n),s.drawImage(e,0,0,640,n),console.log("myWidth, myHeight",640,n);let t=s.getImageData(0,0,640,n),i=!0;for(let e=0;e<t.data.length;e++)if((e+1)%4&&0!==t.data[e]){i=!1;break}i?(setTimeout(l,1e3),console.log("Blank snapshot")):a.toBlob(e=>{let t=new FileReader;t.onload=()=>{m((0,b.MV)({s3KeyPrefix:k,snapshot:t.result}))},t.readAsBinaryString(e),C(!0)})};setTimeout(l,100)}return(0,s.useEffect)(()=>{window.$=window.jQuery=y()},[]),(0,n.jsxs)("div",{children:[(0,n.jsx)("input",{ref:w,onChange:e=>{e.preventDefault(),(0,_.qu)(!1,"handleVideoFiles: ",e.target.id);let a=e.target.files;a.length&&I(a,t)},type:"file",accept:"video/*",className:"d-none editControl",id:"videos"}),(0,n.jsx)(i.Z,{className:"",children:(0,n.jsxs)(d.Z,{children:["Uploaded"===a.status||"Downloaded"===a.status||"DownloadFailed"===a.status||"DownloadingVideo"===a.status||"DownloadedFromServiceWorker"===a.status||"Downloading"===a.status||"DownloadingThumbnail"===a.status||"ThumbnailDownloaded"===a.status?(0,n.jsx)("div",{className:"d-flex justify-content-center align-items-center w-100",children:a.play?(0,n.jsx)(n.Fragment,{children:a.src?(0,n.jsx)("video",{alt:"Video broken",playsInline:!0,controls:!0,autoPlay:!0,muted:!0,poster:a.thumbnail,src:a.src,onPlaying:e=>{(0,_.qu)(!1,"onPlaying ..."),"Uploaded"===a.status&&S(e.target)},onCanPlay:e=>{(0,_.qu)(!1,"onCanPlay ...")},onLoadedMetadata:e=>{(0,_.qu)(!1,"onLoadedMetaData ..., autoplay muted ")},onLoadedData:e=>{(0,_.qu)(!1,"onLoadedData ...")},className:"w-100"}):(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(j.Z,{alt:"image broken",src:a.thumbnail,fluid:!0})})}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(j.Z,{alt:"image broken",src:a.thumbnail||a.placeholder,fluid:!0}),"Downloaded"===a.status&&(0,n.jsx)("div",{style:{position:"absolute",width:"100px",borderRadius:"10px",textAlign:"center",background:"white",opacity:"0.5",cursor:"pointer"},onClick:()=>{o(a.queueId)},children:(0,n.jsx)("i",{className:"fa fa-play-circle-o fa-4x text-danger","aria-hidden":"true"})}),"DownloadingVideo"===a.status&&(0,n.jsx)(N,{})]})}):"","Uploading"===a.status?(0,n.jsx)(v.Z,{now:a.progress}):"",("WaitingForUpload"===a.status||"WaitingForDownload"===a.status)&&(0,n.jsx)("i",{className:"fa fa-video-camera","aria-hidden":"true"})]})}),(0,n.jsx)(i.Z,{className:"",children:(0,n.jsx)(d.Z,{children:"Downloading"===a.status?(0,n.jsx)(v.Z,{now:a.progress}):""})}),(0,n.jsxs)(i.Z,{children:[(0,n.jsx)(d.Z,{xs:8,sm:9,children:(0,n.jsx)("div",{className:"pt-2",children:(0,n.jsx)(f.Z,{editorId:t,mode:c,content:a.words,onContentChanged:u,showPen:!1,editable:h,hideIfEmpty:!0})})}),(0,n.jsx)(d.Z,{xs:4,sm:3,className:"p-0",children:"Uploading"!==a.status||"WaitingForUpload"===a.status?(0,n.jsxs)("div",{children:[h?(0,n.jsx)(g.Z,{variant:"link",align:"end",title:(0,n.jsx)("span",{children:(0,n.jsx)("i",{className:"text-dark fa fa-ellipsis-v","aria-hidden":"true"})}),className:"pull-right",id:"dropdown-menu-align-end",children:(0,n.jsx)(x.Z.Item,{eventKey:"2",className:"deleteVideoBtn",onClick:()=>{confirm("Are you sure you want to delete this video?")&&m((0,b.deleteAVideoThunk)({panel:a}))},children:"Delete Video"})}):"",h?(0,n.jsx)(r.Z,{id:t,onClick:e=>{var t;(0,_.qu)(!1,"handleVideoBtn"),e.preventDefault(),w.current.value=null,null===(t=w.current)||void 0===t||t.click()},variant:"link",className:"px-1 text-dark btn btn-labeled pull-right",children:(0,n.jsx)("i",{id:t,className:"fa fa-video-camera fa-lg","aria-hidden":"true"})}):"",h?(0,n.jsx)(r.Z,{variant:"link",onClick:()=>{p(t)},className:"px-1 text-dark pull-right",children:(0,n.jsx)("i",{className:"fa fa-pencil","aria-hidden":"true"})}):""]}):""})]})]})}function Z(e){let{panelIndex:t,panel:a,onImageClicked:o,editorMode:c,onContentChanged:u,onPenClicked:p,editable:h=!0}=e,m=(0,l.I0)(),w=(0,s.useRef)(null),y=(0,l.v9)(e=>e.container.workspaceKey),N=(e,t)=>{m((0,b.VZ)({files:e,where:t,workspaceKey:y}))};return(0,n.jsxs)("div",{children:[(0,n.jsx)("input",{ref:w,onChange:e=>{e.preventDefault(),(0,_.qu)(!1,"handleImageFiles: ",e.target.id);let a=e.target.files;a.length&&N(a,t)},type:"file",multiple:!0,accept:"image/*",className:"d-none editControl",id:"images"}),(0,n.jsx)(i.Z,{className:"",children:(0,n.jsxs)(d.Z,{children:["Uploaded"===a.status||"Downloaded"===a.status?(0,n.jsx)("div",{children:(0,n.jsx)(j.Z,{alt:"Image broken",src:a.src,onClick:()=>{o(a.queueId)},fluid:!0})}):"","Uploading"===a.status||"Downloading"===a.status?(0,n.jsx)(v.Z,{now:a.progress}):"",("WaitingForUpload"===a.status||"WaitingForDownload"===a.status)&&(0,n.jsx)("i",{className:"fa fa-picture-o","aria-hidden":"true"})]})}),(0,n.jsxs)(i.Z,{children:[(0,n.jsx)(d.Z,{xs:8,sm:9,children:(0,n.jsx)("div",{className:"pt-2",children:(0,n.jsx)(f.Z,{editorId:t,mode:c,content:a.words,onContentChanged:u,showPen:!1,editable:h,hideIfEmpty:!0})})}),(0,n.jsx)(d.Z,{xs:4,sm:3,className:"p-0",children:"Uploaded"===a.status||"Downloaded"===a.status?(0,n.jsxs)("div",{children:[h?(0,n.jsx)(g.Z,{variant:"link",align:"end",title:(0,n.jsx)("span",{children:(0,n.jsx)("i",{className:"text-dark fa fa-ellipsis-v","aria-hidden":"true"})}),className:"pull-right",id:"dropdown-menu-align-end",children:(0,n.jsx)(x.Z.Item,{eventKey:"2",className:"deleteImageBtn",onClick:()=>{confirm("Are you sure you want to delete this image?")&&m((0,b.cJ)({panel:a}))},children:"Delete Image"})}):"",h?(0,n.jsx)(r.Z,{id:t,onClick:e=>{var t;(0,_.qu)(!1,"handleImageBtn"),e.preventDefault(),w.current.value=null,null===(t=w.current)||void 0===t||t.click()},variant:"link",className:"px-1 text-dark btn btn-labeled pull-right",children:(0,n.jsx)("i",{id:t,className:"fa fa-picture-o fa-lg","aria-hidden":"true"})}):"",h?(0,n.jsx)(r.Z,{variant:"link",onClick:()=>{p(t)},className:"px-1 text-dark pull-right",children:(0,n.jsx)("i",{className:"fa fa-pencil","aria-hidden":"true"})}):""]}):""})]})]})}var D=a(84138),C=a(5401),I=a(59209),S=a(72854),q=a(82354),F=a.n(q),E=a(92867);function A(e){let{panelIndex:t,panel:a}=e,o=(0,l.I0)(),c=(0,l.v9)(e=>e.container.workspaceKey),u=(0,l.v9)(e=>e.page.attachmentPanelSelectedForDownload),p=(0,s.useRef)(null),h=e=>{(0,_.qu)(!0,"downloadAnAttachmentOnAndroid ".concat(e));let t={...window.bsafesAndroid.panelSelectedForDownload,uriString:e};o((0,b.sg)({panel:t,workspaceKey:c,uriString:e})),o((0,b.UJ)(null))},m=async()=>{window.bsafesAndroid.downloadAnAttachmentOnAndroid=h,window.bsafesAndroid.panelSelectedForDownload=a,Android&&(console.log("Android.getDownloadedFileUri ..."),Android.getDownloadedFileUri(a.fileName,a.fileType)),o((0,b.UJ)(a))};return(0,s.useEffect)(()=>{if(a.link){var e;null===(e=p.current)||void 0===e||e.click()}},[a]),(0,s.useEffect)(()=>{},[u]),(0,n.jsx)(C.Z,{children:(0,n.jsxs)(C.Z.Body,{children:[(0,n.jsxs)(i.Z,{children:[(0,n.jsx)(d.Z,{xs:8,md:9,children:(0,n.jsxs)("h6",{children:[(0,n.jsx)("i",{className:"fa fa-file-o","aria-hidden":"true"})," ",(0,n.jsx)("span",{className:"attachmentFileName",children:a.fileName})]})}),(0,n.jsx)(d.Z,{xs:4,md:3,children:(0,n.jsxs)("div",{children:[(0,n.jsx)(g.Z,{variant:"link",align:"end",title:(0,n.jsx)("span",{children:(0,n.jsx)("i",{className:"text-dark fa fa-ellipsis-v fa-lg","aria-hidden":"true"})}),className:"".concat(F().attachmentMoreBtn," pull-right"),id:"dropdown-menu-align-end",children:(0,n.jsx)(x.Z.Item,{eventKey:"1",onClick:()=>{confirm("Are you sure you want to delete this attachment?")&&o((0,b.ex)({panel:a}))},children:"Delete"})}),("Uploaded"===a.status||"Downloaded"===a.status)&&(0,n.jsx)(r.Z,{variant:"link",className:"pt-0 px-2 pull-right",onClick:m,children:(0,n.jsx)("i",{className:"text-dark fa fa-download fa-lg","aria-hidden":"true"})}),(0,n.jsx)("a",{ref:p,href:a.link,download:a.fileName,className:"d-none",children:"Save"}),("UploadFailed"===a.status||"DownloadFailed"===a.status)&&(0,n.jsx)(I.Z,{placement:"top",overlay:(0,n.jsx)(S.Z,{id:"ResumeUploadingFile",children:"Resume"}),children:(0,n.jsx)(r.Z,{variant:"link",className:"pt-0 px-2 pull-right",onClick:()=>{"UploadFailed"===a.status||o((0,b.sg)({panel:null,workspaceKey:c}))},children:(0,n.jsx)("i",{className:"text-dark fa fa-play-circle-o fa-lg","aria-hidden":"true"})})}),("WaitingForUpload"===a.status||"WaitingForDownload"===a.status)&&(0,n.jsx)(r.Z,{variant:"link",className:"pt-0 px-2 pull-right",children:(0,n.jsx)("i",{className:"text-dark fa fa-hand-paper-o fa-lg","aria-hidden":"true"})}),("Uploading"===a.status||"Downloading"===a.status)&&(0,n.jsx)(I.Z,{placement:"top",overlay:(0,n.jsx)(S.Z,{id:"StopUploadingFile",children:"Stop"}),children:(0,n.jsx)(r.Z,{variant:"link",className:"pt-0 px-2 pull-right",onClick:()=>{"Uploading"===a.status?o((0,b.k2)()):o((0,b.dc)())},children:(0,n.jsx)("i",{className:"text-dark fa fa-pause fa-lg","aria-hidden":"true"})})})]})})]}),(0,n.jsxs)(i.Z,{children:[(0,n.jsx)(d.Z,{xs:8,md:9,children:(0,n.jsx)("p",{className:"mb-0",children:(0,E.x6)(a.fileSize)+" bytes"})}),(0,n.jsx)(d.Z,{xs:4,md:3,children:("Uploading"===a.status||"UploadFailed"===a.status||"Downloading"===a.status||"DownloadFailed"===a.status)&&(0,n.jsxs)("p",{className:"pull-right",children:[(Math.round(100*a.progress)/100).toFixed(2)," %"]})})]}),(0,n.jsx)(i.Z,{children:(0,n.jsx)(d.Z,{children:"Uploading"===a.status||"UploadFailed"===a.status||"Downloading"===a.status||"DownloadFailed"===a.status?(0,n.jsx)(v.Z,{now:a.progress}):""})})]})})}function W(){let e=(0,l.I0)(),t=(0,l.v9)(e=>e.container.workspaceKey),a=(0,l.v9)(e=>e.container.searchKey),u=(0,l.v9)(e=>e.container.searchIV),h=(0,l.v9)(e=>e.page.activity),g=(0,l.v9)(e=>e.page.id);(0,l.v9)(e=>e.page.itemCopy);let x=(0,l.v9)(e=>e.page.oldVersion),[v,j]=(0,s.useState)("ReadOnly"),w=(0,l.v9)(e=>e.page.title),[y,N]=(0,s.useState)("ReadOnly"),C=(0,l.v9)(e=>e.page.content),[I,S]=(0,s.useState)(null),[q,E]=(0,s.useState)(null),[W,L]=(0,s.useState)(!1),R=(0,l.v9)(e=>e.page.S3SignedUrlForContentUpload),V=(0,l.v9)(e=>e.page.contentImagesDownloadQueue),U=(0,l.v9)(e=>e.page.contentImagesDisplayIndex),B=(0,l.v9)(e=>e.page.contentImagesAllDownloaded),P=U===V.length,O=(0,l.v9)(e=>e.page.contentVideosDownloadQueue),T=(0,l.v9)(e=>e.page.videoPanels),M=(0,l.v9)(e=>e.page.imagePanels),K=(0,l.v9)(e=>e.page.attachmentPanels),H=(0,l.v9)(e=>e.page.comments),z=(0,l.v9)(e=>e.page.draftLoaded),[Q,X]=(0,s.useState)(!1),[J,Y]=(0,s.useState)(!1),G=(0,s.useRef)(null),ee=(0,s.useRef)(null),et=(0,s.useRef)(null),[ea,en]=(0,s.useState)(!1),es=(0,s.useRef)(null),[el,ei]=(0,s.useState)(!1),ed=(0,s.useRef)(null),[er,eo]=(0,s.useState)(!1),ec=t=>{for(let a of((0,_.qu)(!0,"onVideoClicked: ",t),T))if(a.queueId===t){let t=a.queueId,n=a.s3KeyPrefix,s=a.numberOfChunks;e((0,b.f2)({id:t,s3KeyPrefix:n,numberOfChunks:s,fileName:a.fileName,fileType:a.fileType,fileSize:a.fileSize}));break}},eu=e=>{let t;(0,_.qu)(!0,"onImageClicked: ",e);let a=[];for(let n=0;n<M.length;n++){let s=M[n];if("Uploaded"!==s.status&&"Downloaded"!==s.status)continue;let l={};l.src=s.src,l.w=s.width,l.h=s.height,a.push(l),s.queueId===e&&(t=a.length-1)}let n=ee.current,s={history:!1,index:t};new(p())(n,m(),a,s).init()},ep=t=>{let a=t.target;"I"===t.target.tagName&&(a=t.target.parentNode);let n=a.id.replace("playVideoCenter_",""),s=a.parentNode;a.remove();let l=eh(n);s.appendChild(l);let i=n.split("&");if("chunks"===i[0]){let t=i[3],a=parseInt(i[1]),s=i[2],l=parseInt(i[5]),d=i[4];e((0,b.f2)({fromContent:!0,id:n,s3KeyPrefix:t,numberOfChunks:a,fileName:s,fileType:d,fileSize:l}))}else{let t=i[0];e((0,b.f2)({id:n,s3Key:t}))}};function eh(e){let t=G.current.cloneNode(!0);return t.className="bsafesImageSpinner",t.id="spinner_"+e,t.style.position="absolute",t.style.textAlign="center",t.removeAttribute("hidden"),t}function em(e){let t=document.createElement("div"),a="playVideoCenter_"+e.id,n="playVideoButton_"+e.id;return t.className="bsafesPlayVideo",t.id=a,t.style.position="absolute",t.style.width="100px",t.style.borderRadius="10px",t.style.textAlign="center",t.style.background="white",t.style.opacity="0.5",t.innerHTML='<i class="fa fa-play-circle-o fa-4x text-danger" id='.concat(n,' aria-hidden="true"></i>'),t}function ef(){document.querySelectorAll(".bsafesImageSpinner").forEach(e=>{e.remove()}),document.querySelectorAll(".bsafesPlayVideo").forEach(e=>{e.remove()}),S(document.querySelector(".contenEditorRow").querySelector(".inner-html").innerHTML),e((0,b.kj)()),N("Writing")}let eg=t=>{(0,_.qu)(!0,"pen ".concat(t," clicked"));let a=!0;if("content"===t)ef(),E("content"),a=!1;else if("title"===t)j("Writing"),E("title");else if(t.startsWith("video_")){let a=parseInt(t.split("_")[1]);e((0,b.es)({index:a,mode:"Writing"})),E(t)}else if(t.startsWith("image_")){let a=parseInt(t.split("_")[1]);e((0,b.kW)({index:a,mode:"Writing"})),E(t)}else t.startsWith("comment_")&&(e((0,b.pV)({index:t,mode:"Writing"})),E(t));L(a)},ex=(n,s)=>{if((0,_.qu)(!0,"editor-id: ".concat(n," content: ").concat(s)),"content"===q)s!==C?e((0,b.Qs)({content:s,workspaceKey:t})):(ey("ReadOnly"),E(null));else if("title"===q)s!==w?e((0,b.Vf)(s,t,a,u)):(ey("ReadOnly"),E(null));else if(q.startsWith("video_")){let t=parseInt(q.split("_")[1]);console.log(s,T[t].words),s!==T[t].words?e((0,b.f)({index:t,content:s})):(e((0,b.es)({index:t,mode:"ReadOnly"})),E(null))}else if(q.startsWith("image_")){let t=parseInt(q.split("_")[1]);s!==M[t].words?e((0,b.Hk)({index:t,content:s})):(e((0,b.kW)({index:t,mode:"ReadOnly"})),E(null))}else if(q.startsWith("comment_")){if("comment_New"!==q&&H[parseInt(q.split("_")[1])].content===s){e((0,b.pV)({index:q,mode:"ReadOnly"})),E(null);return}e((0,b.qH)({index:q,content:s}))}},ev=T.map((e,t)=>(0,n.jsx)(k,{panelIndex:"video_"+t,panel:e,onVideoClicked:ec,editorMode:e.editorMode,onPenClicked:eg,onContentChanged:ex,editable:!q&&0===h},e.queueId)),ej=M.map((e,t)=>(0,n.jsx)(Z,{panelIndex:"image_"+t,panel:e,onImageClicked:eu,editorMode:e.editorMode,onPenClicked:eg,onContentChanged:ex,editable:!q&&0===h},e.queueId)),ew=()=>{(0,_.qu)(!0,"handleWrite"),ef(),E("content")},ey=t=>{switch(q){case"content":N(t);break;case"title":j(t);break;default:if(q.startsWith("video_")){let a=parseInt(q.split("_")[1]);switch(t){case"Saving":case"ReadOnly":e((0,b.es)({index:a,mode:t}))}}else if(q.startsWith("image_")){let a=parseInt(q.split("_")[1]);switch(t){case"Saving":case"ReadOnly":e((0,b.kW)({index:a,mode:t}))}}else if(q.startsWith("comment_"))switch(t){case"Writing":case"Saving":case"ReadOnly":e((0,b.pV)({index:q,mode:t}))}}},eN=(a,n)=>{e((0,b.ig)({files:a,where:n,workspaceKey:t}))},eb=(a,n)=>{e((0,b.VZ)({files:a,where:n,workspaceKey:t}))},e_=K.map((e,t)=>(0,n.jsx)(A,{panelIndex:"attachment_"+t,panel:e},e.queueId)),ek=a=>{e((0,b.F1)({files:a,workspaceKey:t}))},eZ=(e,t)=>{"videos"===e.target.id?en(t):"images"===e.target.id?ei(t):eo(t)},eD=e=>{(0,_.qu)(!0,"handleDrag"),e.preventDefault(),e.stopPropagation(),"dragenter"===e.type||"dragover"===e.type?eZ(e,!0):"dragleave"===e.type&&eZ(e,!1)},eC=function(e){if((0,_.qu)(!0,"handleDrop: ",e.target.id),e.preventDefault(),e.stopPropagation(),eZ(e,!1),e.dataTransfer.files&&e.dataTransfer.files[0]){if((0,_.qu)(!0,"handleDrop, at least one file."),"videos"===e.target.id){let t=/video.*/,a=[];for(let n of e.dataTransfer.files)n.type.match(t)?a.push(n):(0,_.qu)(!0,"Not an image.");eN(a,"top")}else if("images"===e.target.id){let t=/image.*/,a=[];for(let n of e.dataTransfer.files)n.type.match(t)?a.push(n):(0,_.qu)(!0,"Not an image.");eb(a,"top")}else if("attachments"===e.target.id){(0,_.qu)(!0,"handleDrop attachments: ",e.dataTransfer.files.length);let t=[];for(let a of e.dataTransfer.files)t.push(a);ek(t)}}eZ(e,!1)},eI=e=>{let t;(0,_.qu)(!0,"buildContentImagesGallery");let a=[];document.querySelectorAll(".bSafesImage").forEach(n=>{if(n.src.startsWith("blob")){let s={},l=n.id.split("&")[1].split("x");s.src=n.src,s.w=l[0],s.h=l[1],a.push(s),n.id===e&&(t=a.length-1)}});let n=ee.current,s={history:!1,index:t};new(p())(n,m(),a,s).init()};return(0,s.useEffect)(()=>{(0,_.qu)(!0,"pageCommons mounted.")},[]),(0,s.useEffect)(()=>{S(null)},[g]),(0,s.useEffect)(()=>{0===h?q&&(ey("ReadOnly"),E(null)):"Error"===h&&q&&ey("Writing")},[h]),(0,s.useEffect)(()=>{null!==C&&S(C)},[C]),(0,s.useEffect)(()=>{let t,a,n;if((!z||Q)&&(document.querySelectorAll(".videoControls").forEach(e=>{e.remove()}),U<V.length)){if(t=V[U],!(a=document.getElementById(t.id))){e((0,b.XZ)(U+1));return}if(a.parentNode.classList.contains("bsafesMediaContainer")){if(n=a.parentNode,!document.getElementById("spinner_"+t.id)){let e=eh(t.id);n.appendChild(e)}}else{(n=document.createElement("div")).className="bsafesMediaContainer",n.style.display="flex",n.style.alignItems="center",n.style.justifyContent="center";let e=a.cloneNode(!0);n.appendChild(e),a.replaceWith(n),a=e;let s=eh(t.id);n.appendChild(s)}if("Downloading"===t.status)return;if("Downloaded"===t.status||"DownloadFailed"===t.status){let s=document.getElementById("spinner_"+t.id);if(s&&s.remove(),"Downloaded"===t.status&&(a.src=t.src),a.classList.contains("bSafesDownloadVideo")){let e=null;(e=document.getElementById("playVideoCenter_"+t.id))||"ReadOnly"!==y||(e=em(t),n.appendChild(e)),"ReadOnly"===y&&(e.onclick=ep)}else a.onload=()=>{a.onclick=()=>{eI(a.id)}};e((0,b.XZ)(U+1))}}},[V,Q]),(0,s.useEffect)(()=>{let t,a;for(let n=0;n<O.length;n++){let s=(t=O[n]).id;if(a=document.getElementById(s),"Downloading"===t.status);else if("Downloaded"===t.status||"DownloadedFromServiceWorker"===t.status){let l=document.getElementById("spinner_"+s);if(l&&l.remove(),!a.classList.contains("fr-video")){let l=document.createElement("span");l.className="fr-video",l.classList.add("fr-draggable"),l.setAttribute("contenteditable","true"),l.setAttribute("draggable","true");let i=document.createElement("video");i.className="bSafesVideo",i.classList.add("fr-draggable"),i.classList.add("fr-dvi"),i.classList.add("fr-fvc"),i.setAttribute("controls",""),i.innerHTML="Your browser does not support HTML5 video.",i.id=s,i.src=t.src,i.style=a.style,i.addEventListener("loadeddata",e=>{i.play()}),a.classList.contains("fr-dib")&&l.classList.add("fr-dvb"),a.classList.contains("fr-dii")&&l.classList.add("fr-dvi"),a.classList.contains("fr-fil")&&l.classList.add("fr-fvl"),a.classList.contains("fr-fic")&&l.classList.add("fr-fvc"),a.classList.contains("fr-fir")&&l.classList.add("fr-fvr"),l.appendChild(i),a.replaceWith(l),e((0,b.Z8)({itemId:g,indexInQueue:n}))}}}},[O]),(0,s.useEffect)(()=>{"ReadOnly"===y&&(0,_.qu)(!0,"ReadOnly")},[y]),(0,s.useEffect)(()=>{z&&X(!0)},[z]),(0,s.useEffect)(()=>{Q&&e((0,b.Y2)())},[Q]),(0,s.useEffect)(()=>{B&&z&&(ew(),Y(!1),X(!1))},[B,z]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.Z,{className:"justify-content-center",children:(0,n.jsx)(d.Z,{sm:"10",children:(0,n.jsx)("hr",{})})}),(0,n.jsx)(i.Z,{className:"justify-content-center",children:(0,n.jsx)(d.Z,{sm:"10",children:(0,n.jsx)(f.Z,{editorId:"title",mode:v,content:w,onContentChanged:ex,onPenClicked:eg,editable:!q&&0===h&&!x})})}),(0,n.jsx)(i.Z,{className:"justify-content-center",children:(0,n.jsx)(d.Z,{sm:"10",children:(0,n.jsx)("hr",{})})}),(0,n.jsx)(i.Z,{className:"justify-content-center",children:(0,n.jsx)(d.Z,{className:"contenEditorRow",xs:"12",sm:"10",children:(0,n.jsx)(f.Z,{editorId:"content",mode:y,content:I||C,onContentChanged:ex,onPenClicked:eg,editable:!q&&0===h&&!x&&P,writingModeReady:e=>{},readOnlyModeReady:e=>{let t=document.getElementsByClassName("bSafesDownloadVideo");for(let e=0;e<t.length;e++){let a=t[e],n=a.parentNode,s=em(a);n.appendChild(s),s.onclick=ep}document.querySelectorAll(".bSafesImage").forEach(e=>{e.src.startsWith("blob")&&(e.onclick=()=>{eI(e.id)})})},onDraftSampled:t=>{(0,_.qu)(!0,"draft content: ",t),e((0,b.hL)({content:t}))},onDraftClicked:()=>{e((0,b.KT)())},onDraftDelete:()=>{e((0,b._D)())}})})}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),!q&&0===h&&!x&&(0,n.jsxs)("div",{className:"videos",children:[(0,n.jsx)("input",{ref:et,onChange:e=>{e.preventDefault(),(0,_.qu)(!0,"handleVideoFiles: ",e.target.id);let t=e.target.files;t.length&&eN(t,"top")},type:"file",accept:"video/*",multiple:!0,className:"d-none editControl",id:"videos"}),(0,n.jsx)(i.Z,{children:(0,n.jsx)(d.Z,{id:"videos",onDragEnter:eD,onDragLeave:eD,onDragOver:eD,onDrop:eC,sm:{span:10,offset:1},md:{span:8,offset:2},className:"text-center ".concat(ea?F().videosDragDropZoneActive:F().videosDragDropZone),children:(0,n.jsx)(r.Z,{id:"videos",onClick:e=>{var t;(0,_.qu)(!0,"handleVideoBtn"),e.preventDefault(),et.current.value=null,null===(t=et.current)||void 0===t||t.click()},variant:"link",className:"text-dark btn btn-labeled",children:(0,n.jsx)("h4",{children:(0,n.jsx)("i",{id:"videos",className:"fa fa-video-camera fa-lg","aria-hidden":"true"})})})})})]}),(0,n.jsx)(i.Z,{className:"justify-content-center",children:(0,n.jsx)(d.Z,{xs:"12",md:"8",children:ev})}),(0,n.jsx)("br",{}),!q&&0===h&&!x&&(0,n.jsxs)("div",{className:"images",children:[(0,n.jsx)("input",{ref:es,onChange:e=>{e.preventDefault(),(0,_.qu)(!0,"handleImageFiles: ",e.target.id);let t=e.target.files;t.length&&eb(t,"top")},type:"file",multiple:!0,accept:"image/*",className:"d-none editControl",id:"images"}),(0,n.jsx)(i.Z,{children:(0,n.jsx)(d.Z,{id:"images",onDragLeave:eD,onDragOver:eD,onDrop:eC,sm:{span:10,offset:1},md:{span:8,offset:2},className:"text-center ".concat(el?F().imagesDragDropZoneActive:F().imagesDragDropZone),children:(0,n.jsx)(r.Z,{id:"images",onClick:e=>{var t;(0,_.qu)(!0,"handleImageBtn"),e.preventDefault(),es.current.value=null,null===(t=es.current)||void 0===t||t.click()},variant:"link",className:"text-dark btn btn-labeled",children:(0,n.jsx)("h4",{children:(0,n.jsx)("i",{id:"images",className:"fa fa-picture-o fa-lg","aria-hidden":"true"})})})})})]}),(0,n.jsx)(i.Z,{className:"justify-content-center",children:(0,n.jsx)(d.Z,{xs:"12",sm:"10",lg:"8",children:ej})}),(0,n.jsx)("br",{}),!q&&0===h&&!x&&(0,n.jsxs)("div",{className:"attachments",children:[(0,n.jsx)("input",{ref:ed,onChange:e=>{e.preventDefault(),(0,_.qu)(!0,"handleAttachments: ",e.target.id);let t=e.target.files;t.length&&ek(t)},type:"file",multiple:!0,className:"d-none editControl",id:"attachments"}),(0,n.jsx)(i.Z,{children:(0,n.jsx)(d.Z,{id:"attachments",onDragLeave:eD,onDragOver:eD,onDrop:eC,sm:{span:10,offset:1},md:{span:8,offset:2},className:"text-center ".concat(er?F().attachmentsDragDropZoneActive:F().attachmentsDragDropZone),children:(0,n.jsx)(r.Z,{id:"attachments",onClick:e=>{var t;(0,_.qu)(!0,"handleAttachmentBtn"),e.preventDefault(),ed.current.value=null,null===(t=ed.current)||void 0===t||t.click()},variant:"link",className:"text-dark btn btn-labeled",children:(0,n.jsx)("h4",{children:(0,n.jsx)("i",{id:"attachments",className:"fa fa-paperclip fa-lg","aria-hidden":"true"})})})})})]}),(0,n.jsx)(i.Z,{className:"justify-content-center",children:(0,n.jsx)(d.Z,{xs:"12",md:"8",children:e_})}),(0,n.jsx)("br",{}),(0,n.jsxs)("div",{ref:ee,className:"pswp",tabIndex:"-1",role:"dialog","aria-hidden":"true",children:[(0,n.jsx)("div",{className:"pswp__bg"}),(0,n.jsxs)("div",{className:"pswp__scroll-wrap",children:[(0,n.jsxs)("div",{className:"pswp__container",children:[(0,n.jsx)("div",{className:"pswp__item"}),(0,n.jsx)("div",{className:"pswp__item"}),(0,n.jsx)("div",{className:"pswp__item"})]}),(0,n.jsxs)("div",{className:"pswp__ui pswp__ui--hidden",children:[(0,n.jsxs)("div",{className:"pswp__top-bar",children:[(0,n.jsx)("div",{className:"pswp__counter"}),(0,n.jsx)("button",{className:"pswp__button pswp__button--close",title:"Close (Esc)"}),(0,n.jsx)("button",{className:"pswp__button pswp__button--share",title:"Share"}),(0,n.jsx)("button",{className:"pswp__button pswp__button--fs",title:"Toggle fullscreen"}),(0,n.jsx)("button",{className:"pswp__button pswp__button--zoom",title:"Zoom in/out"}),(0,n.jsx)("div",{className:"pswp__preloader",children:(0,n.jsx)("div",{className:"pswp__preloader__icn",children:(0,n.jsx)("div",{className:"pswp__preloader__cut",children:(0,n.jsx)("div",{className:"pswp__preloader__donut"})})})})]}),(0,n.jsx)("div",{className:"pswp__share-modal pswp__share-modal--hidden pswp__single-tap",children:(0,n.jsx)("div",{className:"pswp__share-tooltip"})}),(0,n.jsx)("button",{className:"pswp__button pswp__button--arrow--left",title:"Previous (arrow left)"}),(0,n.jsx)("button",{className:"pswp__button pswp__button--arrow--right",title:"Next (arrow right)"}),(0,n.jsx)("div",{className:"pswp__caption",children:(0,n.jsx)("div",{className:"pswp__caption__center"})})]})]})]}),!1,(0,n.jsx)(D.Z,{isEditing:q,onWrite:ew,readyForSaving:null!==R||W,onSave:()=>{(0,_.qu)(!0,"handleSave"),ey("Saving"),e((0,b.hX)(!1)),L(!1)},onCancel:()=>{(0,_.qu)(!0,"handleCancel"),e((0,b.ZC)(null)),ey("ReadOnly"),E(null),z&&e((0,b.eD)()),e((0,b.hX)(!1)),L(!1)},canEdit:!q&&0===h&&!x&&P}),!P&&(0,n.jsx)("div",{className:"fixed-bottom",children:(0,n.jsx)(o.Z,{variant:"info",children:"Loading contents, please wait ..."})}),(0,n.jsx)("div",{ref:G,className:"bsafesMediaSpinner",hidden:!0,children:(0,n.jsx)(c.no,{visible:!0,height:"80",width:"80",ariaLabel:"blocks-loading",wrapperStyle:{},wrapperClass:"blocks-wrapper"})})]})}},27432:function(e,t,a){a.d(t,{Z:function(){return c}});var n=a(85893),s=a(67294),l=a(76529),i=a(82280),d=a(88748),r=a(82354),o=a.n(r);function c(e){let{onNextClicked:t,onPreviousClicked:a,cover:r=!1,showAlert:c=!1,alertClosed:u=null}=e,[p,h]=(0,s.useState)(!1);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l.Z,{className:"".concat(o().previousPageBtn," ").concat(r?o().coverBtnFixed:o().pageBtnFixed),onClick:()=>{h(!1),a()},children:(0,n.jsx)("i",{className:"fa fa-chevron-left fa-lg","aria-hidden":"true"})}),(0,n.jsx)(l.Z,{className:"".concat(o().nextPageBtn," ").concat(r?o().coverBtnFixed:o().pageBtnFixed," pull-right"),onClick:()=>{h(!1),t()},children:(0,n.jsx)("i",{className:"fa fa-chevron-right fa-lg","aria-hidden":"true"})}),(0,n.jsx)(d.Z,{className:"p-3",position:r?"top-center":"middle-center",style:{zIndex:1e4},children:(0,n.jsxs)(i.Z,{show:c&&!p,onClose:()=>{h(!0),u()},bg:"warning",children:[(0,n.jsxs)(i.Z.Header,{children:[(0,n.jsx)("strong",{className:"me-auto",children:"Alert"}),(0,n.jsx)("small",{})]}),(0,n.jsx)(i.Z.Body,{children:"Hello, your have reached the end."})]})})]})}}}]);